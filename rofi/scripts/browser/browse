#!/usr/bin/env bash
SCRIPT_DIR="${HOME}/.config/rofi/scripts"

AMAZON_PRIME_VIDEO="Amazon Prime Video"
CHANNEL_4="Channel 4"
DISNEY_PLUS="Disney+"
NETFLIX="Netflix"
YOUTUBE="Youtube"

declare -A SITES=(
    ["${AMAZON_PRIME_VIDEO}"]="www.amazon.co.uk/gp/video/storefront/"
    ["${CHANNEL_4}"]="www.channel4.com/"
    ["${DISNEY_PLUS}"]="www.disneyplus.com"
    ["${NETFLIX}"]="www.netflix.com"
    ["${YOUTUBE}"]="www.youtube.com"
    ["BT Mail"]="mail.bt.com"
    ["Channel 4"]="www.channel4.com"
    ["Chess"]="www.chess.com"
    ["GMail"]="mail.google.com"
    ["Github"]="www.github.com/ChrisPJohnstone"
    ["Google Sheets"]="sheets.google.com"
    ["iCloud"]="www.icloud.com"
    ["LinkedIn"]="www.linkedin.com"
    ["Outlook"]="outlook.live.com"
    ["Pihole"]="192.168.0.201/admin"
    ["Proton Mail"]="mail.proton.me"
    ["Proxmox"]="192.168.0.200:8006"
    ["RSS"]="rss.ghastly.uk"
    ["Spotify"]="open.spotify.com"
    ["Reddit"]="www.reddit.com"
    ["Router"]="192.168.0.1"
    ["Teams"]="teams.live.com"
    ["Top Cashback"]="www.topcashback.co.uk"
    ["Vaultwarden"]="vaultwarden.ghastly.uk"
    ["Vinted"]="www.vinted.co.uk"
    ["Wifi"]="192.168.0.1"
    ["WhatsApp"]="web.whatsapp.com"
)
declare -A FOLLOW_UPS=(
    ["${AMAZON_PRIME_VIDEO}"]="${SCRIPT_DIR}/browser/search_prime_video"
    ["${NETFLIX}"]="${SCRIPT_DIR}/browser/search_netflix"
    ["${YOUTUBE}"]="${SCRIPT_DIR}/browser/search_youtube"
)
declare -A OPEN_SCRIPTS=(
    ["${CHANNEL_4}"]="${SCRIPT_DIR}/browser/open_with_vpn_off"
    ["${DISNEY_PLUS}"]="${SCRIPT_DIR}/browser/open_with_vpn_off"
)

INPUT=$(printf '%s\n' "${!SITES[@]}" | rofi -i -dmenu -p "Browse")
if [[ -z ${INPUT} ]]; then
    exit 1
elif [[ -z "${SITES[${INPUT}]}" ]]; then
    "${SCRIPT_DIR}/browser/search_ddg" "$1" "${INPUT}"
elif [[ -n "${FOLLOW_UPS[${INPUT}]}" ]]; then
    secondary_input=$("${SCRIPT_DIR}/input" "${INPUT}")
    eval "${FOLLOW_UPS[${INPUT}]} $1 \"${secondary_input}\""
elif [[ -n "${OPEN_SCRIPTS[${INPUT}]}" ]]; then
    eval "${OPEN_SCRIPTS[${INPUT}]} $1 ${SITES[${INPUT}]}"
else
    $1 "${SITES[${INPUT}]}"
fi
